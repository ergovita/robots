<script>
function ValidaForm(){

 //Contato Nome
 if(isEmpty(document.formPesquisa.NomeDe.value)){
    AvisoErroCampo(document.formPesquisa.NomeDe,'Informe seu nome.');
    return false;
 }

 //E-mail
 if(isEmpty(document.formPesquisa.EmailDe.value) || !ValidaEmailInt(document.formPesquisa.EmailDe.value)){
    AvisoErroCampo(document.formPesquisa.EmailDe,'Informe seu e-mail.');
    return false;
 }

 // Verifica se foi escolhido Prazo Informado
 var checkedButton=false;
 for (i=0;i<3;i++) if(document.formPesquisa.Pergunta_01[i].checked) checkedButton=true;
 if (!checkedButton) {
   alert("Informe se a loja realizou a entrega no prazo informado.");
   document.formPesquisa.Pergunta_01[0].focus();
   return false;
 }

 // Verifica se encontrou o que desejava
 var checkedButton=false;
 for (i=0;i<2;i++) if(document.formPesquisa.Pergunta_02[i].checked) checkedButton=true;
 if (!checkedButton) {
   alert("Informe se encontrou o que desejava.");
   document.formPesquisa.Pergunta_02[0].focus();
   return false;
 }

 // Verifica se pode melhorar algo
 var checkedButton=false;
 for (i=0;i<3;i++) if(document.formPesquisa.Pergunta_03[i].checked) checkedButton=true;
 if (!checkedButton) {
   alert("Informe o que poderíamos melhorar.");
   document.formPesquisa.Pergunta_03[0].focus();
   return false;
 }


 // Verifica qual promoção gostaria de ver na loja
 var checkedButton=false;
 for (i=0;i<3;i++) if(document.formPesquisa.Pergunta_04[i].checked) checkedButton=true;
 if (!checkedButton) {
   alert("Informe qual promoção gostaria de ver na loja virtual.");
   document.formPesquisa.Pergunta_04[0].focus();
   return false;
 }

 // Verifica se encontrou dificuldades
 var checkedButton=false;
 for (i=0;i<2;i++) if(document.formPesquisa.Pergunta_05[i].checked) checkedButton=true;
 if (!checkedButton) {
   alert("Informe se encontrou dificuldades em fechar o pedido na loja.");
   document.formPesquisa.Pergunta_05[0].focus();
   return false;
 }

 // Verifica se precisou de ajuda para fechar o pedido
 var checkedButton=false;
 for (i=0;i<3;i++) if(document.formPesquisa.Pergunta_06[i].checked) checkedButton=true;
 if (!checkedButton) {
   alert("Informe se precisou de ajuda para realizar o pedido.");
   document.formPesquisa.Pergunta_06[0].focus();
   return false;
 }

 //Comentários
 if(isEmpty(document.formPesquisa.Comentarios.value)){
    AvisoErroCampo(document.formPesquisa.Comentarios,'Comentário não pode ser branco.');
    return false;
 }

 document.formPesquisa.submit();
}

function ValidaEmailInt(sEmail) {
  var regex=/^[a-zA-Z0-9._-]+@([a-zA-Z0-9.-]+\.)+[a-zA-Z0-9.-]{2,4}$/;
  return regex.test(sEmail);
}

function retiraEspaco(theString) {
//retira espaços de string
  if(theString.indexOf(" ")>=0){
    var i=0;
    while(theString.indexOf(" ")>=0){
      if(theString.charAt(i)==" ")theString=theString.substring(0,i)+theString.substring(i+1,theString.length);
      else i++;
    }
    newString=theString;
  } 
  else newString=theString;
  return newString;
}

function isEmpty(s){return((retiraEspaco(s)==null)||(retiraEspaco(s).length==0));}

function AvisoErroCampo(theField,warnText){
  theField.focus();
  theField.select();
  alert(warnText);
  return false;
}

function AvisoErroCampo_SelectBox(theField,s){
  theField.focus();
  alert(s);
  return false;
}
</script>

<style>
.EstTabPedidoTit{background:#eeeeee;border:1px solid #dedede}
</style>

<table align=center width=90% cellspacing=1 cellpadding=5 class=EstTabPedido border=0>
      <form name=formPesquisa method=POST action=EnviaMail.asp>
        <input type=hidden name=NomePara value='<NomeLoja>'>
        <input type=hidden name=EmailPara value='<mailinfo>'>
        <input type=hidden name=Assunto value='Pesquisa de satisfação'>
        <input type=hidden name=URLRetorno value='<HTMLoja>PesqObrigado.htm'>
        <input type=hidden name=OrdemCampos value='NomeDe,EmailDe,Pergunta_01,Pergunta_02,Pergunta_03,Pergunta_04,Pergunta_05,Pergunta_06,Comentarios'>
  <tr>
    <td align=center colspan=3 class=EstTabPedidoTit>Por favor, pedimos que responda às perguntas abaixo para nos ajudar a melhorar a qualidade de nossos serviços.</td>
  </tr>
  <tr>
    <td align=right class=EstNomeCampo>Nome:</td>
    <td colspan=2><input type=text name=NomeDe class=InputText size=45 maxlength=50></td>
  </tr>
  <tr>
    <td align=right class=EstNomeCampo>E-mail:</td>
    <td colspan=2><input type=text name=EmailDe class=InputText size=45 maxlength=50></td>
  </tr>

  <tr>
    <td colspan=3 class=EstTabPedidoTit>O pedido foi recebido no prazo informado pela loja?</td>
  </tr>
  <tr>
    <td>
      <input type=radio name="Pergunta_01" value="Sim, recebi antes do prazo">Recebi antes do prazo.
    </td>
    <td>
      <input type=radio name="Pergunta_01" value="Sim, recebi no prazo">Recebi no prazo exato.
    </td>
    <td>
      <input type=radio name="Pergunta_01" value="Não, recebi depois do prazo">Recebi depois do prazo.
    </td>
  </tr>

  <tr>
    <td colspan=3 class=EstTabPedidoTit>Foi fácil encontrar o que desejava?</td>
  </tr>
  <tr>
    <td>
      <input type=radio name="Pergunta_02" value="Sim">Sim
    </td>
    <td>
      <input type=radio name="Pergunta_02" value="Não">Não
    </td>
    <td>
      &nbsp;
    </td>
  </tr>

  <tr>
    <td colspan=3 class=EstTabPedidoTit>O que poderíamos melhorar na loja virtual?</td>
  </tr>
  <tr>
    <td>
      <input type=radio name="Pergunta_03" value="Variedade">Variedade
    </td>
    <td>
      <input type=radio name="Pergunta_03" value="Preço">Preço
    </td>
    <td>
      <input type=radio name="Pergunta_03" value="Navegação">Navegação
    </td>
  </tr>

  <tr>
    <td colspan=3 class=EstTabPedidoTit>Qual promoção gostaria de ver em nosso site?</td>
  </tr>
  <tr>
    <td>
      <input type=radio name="Pergunta_04" value="Frete Grátis">Frete Grátis
    </td>
    <td>
      <input type=radio name="Pergunta_04" value="Desconto no pagamento à vista">Desconto no pagamento à vista
    </td>
    <td>
      <input type=radio name="Pergunta_04" value="Brindes">Brindes
    </td>
  </tr>

  <tr>
    <td colspan=3 class=EstTabPedidoTit>Encontrou dificuldades em fazer o pedido?</td>
  </tr>
  <tr>
    <td>
      <input type=radio name="Pergunta_05" value="Sim">Sim
    </td>
    <td>
      <input type=radio name="Pergunta_05" value="Não">Não
    </td>
    <td>
      &nbsp;
    </td>
  </tr>

  <tr>
    <td colspan=3 class=EstTabPedidoTit>Precisou da ajuda para realizar o pedido?</td>
  </tr>
  <tr>
    <td>
      <input type=radio name="Pergunta_06" value="Sim. Liguei para o atendimento">Sim. Liguei para o atendimento.
    </td>
    <td>
      <input type=radio name="Pergunta_06" value="Sim. Utilizei o chat">Sim. Utilizei o chat.
    </td>
    <td>
      <input type=radio name="Pergunta_06" value="Não">Não
    </td>
  </tr>

  <tr>
    <td colspan=3 align=center class=EstTabPedidoTit>Outros comentários</td>
  </tr>
  <tr>
    <td colspan=3 align=center><textarea wrap=virtual cols=18 rows=4 name="Comentarios" class=InputText style=height:50px;width:550px></textarea></td>
  </tr>
  <tr>
    <td colspan=3 align=center><input type=button name=Enviar value=' Enviar ' class=InputButton onclick='javascript:ValidaForm()'></td>
  </tr></form>
</table>